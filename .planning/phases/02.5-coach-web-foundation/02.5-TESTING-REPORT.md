# Phase 2.5 Testing Report

**Phase:** 02.5-coach-web-foundation
**Executed:** 2026-01-24
**Status:** Ready for testing

---

## What Was Built

Phase 2.5 implemented the **Coach Web Foundation** - the frontend UI for authentication, athlete management, and exercise browsing. This catches up the frontend to use the backend APIs built in Phases 1-2.

### Routes Created

| Route | Purpose | Auth Required |
|-------|---------|---------------|
| `/` | Redirects to `/dashboard` or `/login` | Checked |
| `/login` | Email/password + Google OAuth login | No (redirects if logged in) |
| `/signup` | Account creation | No (redirects if logged in) |
| `/onboarding` | Organization creation for new users | Yes |
| `/dashboard` | Stats, recent activity, quick actions | Yes |
| `/athletes` | Athlete list with CRUD operations | Yes |
| `/exercises` | Exercise browser with filters | Yes |

### Features Created

```
apps/coach-web/src/features/
├── auth/
│   ├── components/
│   │   ├── auth-layout.tsx      # Split-screen layout
│   │   ├── oauth-buttons.tsx    # Google OAuth
│   │   ├── login-form.tsx
│   │   ├── signup-form.tsx
│   │   └── org-form.tsx
│   └── views/
│       ├── login-view.tsx
│       ├── signup-view.tsx
│       └── onboarding-view.tsx
├── athletes/
│   ├── components/
│   │   ├── athletes-table.tsx
│   │   ├── athlete-form.tsx
│   │   └── invitation-status.tsx
│   ├── hooks/
│   │   ├── queries/use-athletes.ts
│   │   └── mutations/ (create, update, archive, generate-invitation)
│   └── views/athletes-list-view.tsx
├── exercises/
│   ├── components/
│   │   ├── exercises-table.tsx
│   │   ├── muscle-badges.tsx
│   │   └── exercise-filters.tsx
│   ├── hooks/queries/ (use-exercises, use-muscle-groups)
│   └── views/exercises-browser-view.tsx
└── dashboard/
    ├── components/
    │   ├── stats-cards.tsx
    │   ├── recent-activity.tsx
    │   └── quick-actions.tsx
    ├── hooks/use-dashboard-stats.ts
    └── views/dashboard-view.tsx
```

### Shared Components Created

```
apps/coach-web/src/components/
├── data-table/
│   ├── data-table.tsx           # Compound component (Root, Content)
│   ├── data-table-pagination.tsx
│   ├── data-table-search.tsx
│   ├── data-table-toolbar.tsx
│   └── data-table-row-actions.tsx
└── layout/
    ├── app-shell.tsx
    ├── app-sidebar.tsx
    ├── user-menu.tsx
    └── breadcrumbs.tsx
```

---

## How to Run

### Prerequisites

1. **Database** must be running and seeded:
   ```bash
   pnpm db:start    # Start PostgreSQL container
   pnpm db:push     # Push schema (if not done)
   pnpm db:seed     # Seed exercises and muscle groups
   ```

2. **Environment variables** in `apps/server/.dev.vars`:
   ```
   DATABASE_URL=postgresql://...
   BETTER_AUTH_SECRET=<generate with openssl rand -base64 32>
   ```

3. **Optional:** For Google OAuth, set:
   ```
   GOOGLE_CLIENT_ID=...
   GOOGLE_CLIENT_SECRET=...
   ```
   And in `apps/coach-web/.env`:
   ```
   VITE_GOOGLE_OAUTH_ENABLED=true
   ```

### Start Development Servers

```bash
# Terminal 1: API Server
pnpm dev:server

# Terminal 2: Coach Web App
pnpm dev:coach
```

Then open: **http://localhost:5173**

---

## Testing Checklist

### 1. Initial Load & Routing
- [ ] Open http://localhost:5173
- [ ] Should redirect to `/login` (not authenticated)
- [ ] No console errors

### 2. Signup Flow
- [ ] Click "Sign up" or go to `/signup`
- [ ] See split-screen layout (logo left, form right)
- [ ] Fill form: name, email, password (min 8 chars)
- [ ] Submit → should redirect to `/onboarding`
- [ ] Create organization: enter name, slug auto-generates
- [ ] Submit → should redirect to `/dashboard`

### 3. Login Flow
- [ ] Log out (user menu → Logout)
- [ ] Go to `/login`
- [ ] Enter credentials from signup
- [ ] Check "Remember me"
- [ ] Submit → should redirect to `/dashboard`

### 4. App Shell
- [ ] Sidebar visible with: Dashboard, Athletes, Exercises
- [ ] Click sidebar toggle → collapses/expands
- [ ] Refresh page → sidebar state persists
- [ ] Breadcrumbs show current path
- [ ] User menu opens on avatar click
- [ ] Theme toggle works (Light/Dark/System)

### 5. Dashboard
- [ ] Shows welcome message with organization name
- [ ] Stats cards show: Total Athletes, Active, Pending Invitations
- [ ] Recent Activity section visible (empty if no athletes)
- [ ] Quick Actions: "Manage Athletes" and "Browse Exercises" links work

### 6. Athletes Page
- [ ] Navigate to `/athletes`
- [ ] Click "Add Athlete" → drawer opens
- [ ] Fill form (name required) → submit
- [ ] New athlete appears in list
- [ ] Search works (type name, results filter)
- [ ] Click three-dot menu → Edit → drawer opens with data
- [ ] Update athlete → changes reflected
- [ ] Click three-dot menu → Generate Invite → toast shows "Invitation link copied!"
- [ ] Paste clipboard → should have invitation URL
- [ ] Click three-dot menu → Archive → confirm → athlete hidden
- [ ] Toggle "Show archived" → archived athlete visible

### 7. Exercises Page
- [ ] Navigate to `/exercises`
- [ ] List shows seeded exercises (60 curated)
- [ ] Search works (type "bench", results filter)
- [ ] Muscle group dropdown filters work
- [ ] Movement pattern dropdown filters work
- [ ] "Curated" badge shows on curated exercises
- [ ] Muscle badges show (primary solid, secondary outline)
- [ ] Pagination works (default 25 per page)

### 8. Auth Edge Cases
- [ ] While logged in, go to `/login` → redirects to `/dashboard`
- [ ] While logged in, go to `/signup` → redirects to `/dashboard`
- [ ] Log out → redirected to `/login`
- [ ] Try accessing `/athletes` directly when logged out → redirects to `/login`

---

## Known Implementation Details

### Authentication
- Uses Better Auth client from `lib/auth-client.ts`
- Session checked via `authClient.getSession()`
- Organization context from `authClient.useActiveOrganization()`

### API Integration
- oRPC client from `lib/api-client.ts`
- All hooks use TanStack Query
- Cache invalidation on mutations via query keys

### Forms
- React Hook Form with `standardSchemaResolver`
- Schemas imported from `@strenly/contracts`
- Validation errors shown inline with Field components

### Data Tables
- Custom DataTable compound component
- Server-side pagination (manualPagination: true)
- 300ms debounced search

### Toast Notifications
- Sonner library
- Success toasts: green
- Error toasts: red
- Position: top-right

---

## If Something Doesn't Work

### "Cannot find module" errors
```bash
pnpm install
pnpm typecheck
```

### Database connection errors
```bash
pnpm db:start
# Check DATABASE_URL in apps/server/.dev.vars
```

### Routes not found / 404
```bash
# Regenerate TanStack Router types
pnpm --filter coach-web dev
# Routes auto-generate on dev server start
```

### Auth not working
- Check `BETTER_AUTH_SECRET` is set
- Check server is running on correct port
- Check browser console for CORS errors

### Empty exercise list
```bash
pnpm db:seed  # Seeds 60 curated exercises
```

---

## Next Steps After Testing

If all tests pass:
```bash
/gsd:verify-work 2.5  # Run verification
/gsd:progress         # Check overall progress
```

If issues found:
- Document specific failures
- Check browser console for errors
- Check server logs for API errors

---

*Report generated: 2026-01-24*
*Phase: 02.5-coach-web-foundation*
