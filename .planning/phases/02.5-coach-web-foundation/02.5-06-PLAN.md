---
phase: 02.5-coach-web-foundation
plan: 06
type: execute
wave: 4
depends_on: ["02.5-03", "02.5-04", "02.5-05"]
files_modified:
  - apps/coach-web/src/routes/_authenticated/dashboard.tsx
  - apps/coach-web/src/features/dashboard/views/dashboard-view.tsx
  - apps/coach-web/src/features/dashboard/components/stats-cards.tsx
  - apps/coach-web/src/features/dashboard/components/recent-activity.tsx
  - apps/coach-web/src/features/dashboard/hooks/use-dashboard-stats.ts
  - apps/coach-web/src/routes/index.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard shows total athletes count"
    - "Dashboard shows pending invitations count"
    - "Dashboard shows active athletes count"
    - "Dashboard provides quick navigation to Athletes and Exercises"
    - "Root path (/) redirects to /dashboard when authenticated"
  artifacts:
    - path: "apps/coach-web/src/features/dashboard/views/dashboard-view.tsx"
      provides: "Dashboard page"
      min_lines: 40
    - path: "apps/coach-web/src/features/dashboard/components/stats-cards.tsx"
      provides: "Summary stat cards"
      min_lines: 30
  key_links:
    - from: "apps/coach-web/src/features/dashboard/views/dashboard-view.tsx"
      to: "features/athletes/hooks/queries/use-athletes.ts"
      via: "useAthletes for stats"
      pattern: "useAthletes"
    - from: "apps/coach-web/src/routes/index.tsx"
      to: "_authenticated/dashboard.tsx"
      via: "redirect"
      pattern: "redirect.*dashboard"
---

<objective>
Create the dashboard landing page with summary statistics and quick navigation.

Purpose: Dashboard is the first page coaches see after login, providing overview of their organization.
Output: Dashboard with athlete stats, pending invitations, and quick links to features.
</objective>

<execution_context>
@/Users/tomiardz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tomiardz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02.5-coach-web-foundation/02.5-CONTEXT.md
@.planning/phases/02.5-coach-web-foundation/02.5-RESEARCH.md
@.planning/phases/02.5-coach-web-foundation/02.5-04-SUMMARY.md
@apps/coach-web/src/lib/api-client.ts
@apps/coach-web/src/components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard stats hook and cards</name>
  <files>
    apps/coach-web/src/features/dashboard/hooks/use-dashboard-stats.ts
    apps/coach-web/src/features/dashboard/components/stats-cards.tsx
  </files>
  <action>
Create the dashboard stats fetching and display:

1. Create `features/dashboard/hooks/use-dashboard-stats.ts`:
   - Fetch athlete stats using multiple queries
   - useAthletes({ status: 'active', limit: 1 }) for active count (use totalCount)
   - useAthletes({ limit: 1 }) for total count
   - Combine into stats object: { totalAthletes, activeAthletes, pendingInvitations }
   - For pending invitations, calculate from totalAthletes - linkedAthletes (or add a dedicated query later)
   - Return { stats, isLoading }

2. Create `features/dashboard/components/stats-cards.tsx`:
   - Grid of stat cards (3 columns on lg, 1 on mobile)
   - Each card: icon, label, value, optional description
   - Cards:
     - Total Athletes (Users icon, count, "in your organization")
     - Active Athletes (UserCheck icon, count, "currently training")
     - Pending Invitations (Mail icon, count, "awaiting acceptance")
   - Use shadcn Card with CardHeader, CardContent
   - Show skeleton when loading
   - Props: stats, isLoading

Card structure:
```typescript
<Card>
  <CardHeader className="flex flex-row items-center justify-between pb-2">
    <CardTitle className="text-sm font-medium text-muted-foreground">
      {label}
    </CardTitle>
    <Icon className="h-4 w-4 text-muted-foreground" />
  </CardHeader>
  <CardContent>
    <div className="text-2xl font-bold">{value}</div>
    <p className="text-xs text-muted-foreground">{description}</p>
  </CardContent>
</Card>
```
  </action>
  <verify>
Import StatsCards with mock stats and verify cards render correctly.
  </verify>
  <done>
Dashboard stats hook fetches data and cards display correctly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create recent activity component</name>
  <files>
    apps/coach-web/src/features/dashboard/components/recent-activity.tsx
  </files>
  <action>
Create a recent activity component for the dashboard:

1. Create `features/dashboard/components/recent-activity.tsx`:
   - Card showing recent athletes (last 5 created)
   - Use useAthletes({ limit: 5 }) to fetch recent athletes
   - List items showing: athlete name, created date (relative), status badge
   - "View all" link to /athletes
   - Empty state if no athletes
   - Show skeleton when loading

Structure:
```typescript
<Card>
  <CardHeader>
    <div className="flex items-center justify-between">
      <CardTitle>Recent Athletes</CardTitle>
      <Link to="/athletes" className="text-sm text-muted-foreground hover:underline">
        View all
      </Link>
    </div>
  </CardHeader>
  <CardContent>
    {athletes.length === 0 ? (
      <p className="text-sm text-muted-foreground">No athletes yet</p>
    ) : (
      <div className="space-y-4">
        {athletes.map((athlete) => (
          <div key={athlete.id} className="flex items-center justify-between">
            <div>
              <p className="font-medium">{athlete.name}</p>
              <p className="text-sm text-muted-foreground">
                Added {formatDistanceToNow(new Date(athlete.createdAt))} ago
              </p>
            </div>
            <Badge variant={athlete.status === 'active' ? 'default' : 'secondary'}>
              {capitalize(athlete.status)}
            </Badge>
          </div>
        ))}
      </div>
    )}
  </CardContent>
</Card>
```
  </action>
  <verify>
Import RecentActivity and verify it displays recent athletes correctly.
  </verify>
  <done>
Recent activity component shows last 5 athletes with relative dates.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create dashboard view and routes</name>
  <files>
    apps/coach-web/src/features/dashboard/views/dashboard-view.tsx
    apps/coach-web/src/routes/_authenticated/dashboard.tsx
    apps/coach-web/src/routes/index.tsx
  </files>
  <action>
Create the dashboard view and configure routes:

1. Create `features/dashboard/views/dashboard-view.tsx`:
   - Welcome message with organization name from useActiveOrganization
   - StatsCards component
   - Two-column layout on lg: RecentActivity (left), Quick Actions (right)
   - Quick Actions card with links: "Manage Athletes", "Browse Exercises"
   - Use Link from TanStack Router for navigation

2. Create `routes/_authenticated/dashboard.tsx`:
   - createFileRoute with '/_authenticated/dashboard' path
   - component: DashboardView

3. Create `routes/index.tsx`:
   - createFileRoute with '/' path
   - beforeLoad: redirect to '/dashboard' if authenticated, '/login' if not
   - Use authClient.getSession() to check auth status

Dashboard layout:
```typescript
export function DashboardView() {
  const { data: org } = useActiveOrganization()
  const { stats, isLoading } = useDashboardStats()

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold">
          Welcome to {org?.name ?? 'Strenly'}
        </h1>
        <p className="text-muted-foreground">
          Here's an overview of your organization
        </p>
      </div>

      <StatsCards stats={stats} isLoading={isLoading} />

      <div className="grid gap-6 lg:grid-cols-2">
        <RecentActivity />
        <QuickActions />
      </div>
    </div>
  )
}
```

Quick Actions card:
```typescript
<Card>
  <CardHeader>
    <CardTitle>Quick Actions</CardTitle>
  </CardHeader>
  <CardContent className="space-y-2">
    <Button asChild variant="outline" className="w-full justify-start">
      <Link to="/athletes">
        <Users className="mr-2 h-4 w-4" />
        Manage Athletes
      </Link>
    </Button>
    <Button asChild variant="outline" className="w-full justify-start">
      <Link to="/exercises">
        <Dumbbell className="mr-2 h-4 w-4" />
        Browse Exercises
      </Link>
    </Button>
  </CardContent>
</Card>
```
  </action>
  <verify>
Navigate to / and verify redirect to /dashboard, then verify dashboard displays correctly.
  </verify>
  <done>
Dashboard displays stats, recent activity, and quick actions with correct navigation.
  </done>
</task>

</tasks>

<verification>
1. Run `pnpm typecheck` - no errors
2. Run `pnpm lint` - no errors
3. Navigate to / - should redirect to /dashboard (if authenticated) or /login
4. Verify dashboard shows welcome message with org name
5. Verify stats cards show correct counts
6. Verify recent activity shows last 5 athletes
7. Verify quick action links navigate to correct pages
8. Verify responsive layout (grid collapses on mobile)
</verification>

<success_criteria>
- Root path redirects appropriately based on auth status
- Dashboard shows organization name in welcome message
- Stats cards display total, active athletes, and pending invitations
- Recent activity shows last 5 athletes with relative dates
- Quick actions link to Athletes and Exercises pages
- Layout is responsive (single column on mobile, multi on desktop)
- Loading states show skeletons
- No TypeScript or lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/02.5-coach-web-foundation/02.5-06-SUMMARY.md`
</output>
