---
phase: 02.5-coach-web-foundation
plan: 09
subsystem: ui
tags: [zod, react-hook-form, sheet, forms, validation]

# Dependency graph
requires:
  - phase: 02.5-coach-web-foundation
    provides: "Athlete form and CRUD UI components"
provides:
  - Custom Zod validation error messages for athlete contracts
  - SheetBody component for scrollable drawer content
  - Proper form button placement in SheetFooter
affects: [forms, sheets, validation]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Custom error messages in Zod schemas via { message: '...' }"
    - "Sheet structure: Header > Body (scrollable) > Footer (fixed buttons)"
    - "External form submission via form id prop"

key-files:
  created: []
  modified:
    - packages/contracts/src/athletes/athlete.ts
    - apps/coach-web/src/components/ui/sheet.tsx
    - apps/coach-web/src/features/athletes/views/athletes-list-view.tsx
    - apps/coach-web/src/features/athletes/components/athlete-form.tsx

key-decisions:
  - "Custom Zod messages over inline form-level messages for consistency"
  - "Use .or(z.literal('')) for optional string fields to handle empty form inputs"
  - "Form buttons in SheetFooter for consistent drawer UX"
  - "Form id prop for external submit button linking"

patterns-established:
  - "Zod custom messages: .min(1, { message: 'Name is required' })"
  - "Optional strings: z.string().optional().or(z.literal(''))"
  - "Sheet form pattern: SheetBody for form, SheetFooter for buttons"

# Metrics
duration: 3min
completed: 2026-01-24
---

# Phase 2.5 Plan 09: Form UX Polish Summary

**User-friendly Zod error messages and proper Sheet drawer layout with scrollable body and fixed footer buttons**

## Performance

- **Duration:** 3 min
- **Started:** 2026-01-24T14:52:23Z
- **Completed:** 2026-01-24T14:55:30Z
- **Tasks:** 2
- **Files modified:** 4

## Accomplishments
- Custom error messages for all athlete form validation (name required, email format, notes length)
- New SheetBody component for scrollable content with horizontal padding
- Form buttons moved to SheetFooter for fixed position at drawer bottom
- Form id prop enables external submit buttons to trigger form submission

## Task Commits

Each task was committed atomically:

1. **Task 1: Add custom error messages to athlete contracts** - `4c373cc` (feat)
2. **Task 2: Fix Sheet styling and form button placement** - `77a5fc9` (feat)

**Plan metadata:** pending (docs: complete plan)

## Files Created/Modified
- `packages/contracts/src/athletes/athlete.ts` - Added custom error messages to createAthleteInputSchema and listAthletesInputSchema
- `apps/coach-web/src/components/ui/sheet.tsx` - Added SheetBody component for scrollable content
- `apps/coach-web/src/features/athletes/views/athletes-list-view.tsx` - Restructured to use SheetBody and SheetFooter
- `apps/coach-web/src/features/athletes/components/athlete-form.tsx` - Added id prop, removed internal buttons

## Decisions Made
- **Custom Zod messages:** Added `{ message: '...' }` to validation rules instead of form-level messages for consistent error text across the app
- **Empty string handling:** Used `.or(z.literal(''))` pattern for optional string fields since HTML forms submit empty strings for unfilled optional inputs
- **Form id pattern:** Added `id` prop to AthleteForm and `form="athlete-form"` on submit button to decouple form content from form actions

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Removed unused isSubmitting prop from AthleteForm**
- **Found during:** Task 2 (Sheet restructure)
- **Issue:** After moving buttons to SheetFooter, AthleteForm no longer used isSubmitting prop but TypeScript errored on unused variable
- **Fix:** Removed isSubmitting from both props type and function signature
- **Files modified:** apps/coach-web/src/features/athletes/components/athlete-form.tsx
- **Verification:** pnpm typecheck passes
- **Committed in:** 77a5fc9 (Task 2 commit)

---

**Total deviations:** 1 auto-fixed (1 blocking)
**Impact on plan:** Necessary TypeScript fix for unused variable. No scope creep.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Form validation now shows clear, user-friendly error messages
- Sheet component follows proper structure for forms with scrollable content
- Pattern established for future forms using Sheet drawers

---
*Phase: 02.5-coach-web-foundation*
*Completed: 2026-01-24*
