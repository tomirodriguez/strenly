---
status: complete
phase: 02.5-coach-web-foundation
source: ROADMAP.md success criteria
started: 2026-01-24T12:30:00Z
updated: 2026-01-25T18:30:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Sign Up, Log In, Log Out
expected: Create account at /signup, log in at /login, log out via user menu. After logout, redirected to /login and cannot access protected routes.
result: pass

### 2. Organization Onboarding
expected: After signup (or if no organization), redirected to /onboarding. Create organization with name and slug. After creation, redirected to /dashboard.
result: pass

### 3. Athletes List with Search and Pagination
expected: /athletes shows table with athlete data. Search input filters by name/email. Pagination controls at bottom work correctly.
result: pass

### 4. Create, Edit, Archive Athletes
expected: Click "Add Athlete" → modal opens with form. Fill and submit → athlete appears in list. Edit via row menu. Archive via row menu → athlete removed or marked inactive.
result: issue
reported: "Cuando se quiere agregar una atleta, falla cuando el email está vacío. Frontend validation pasa pero backend rechaza con VALIDATION_ERROR 500. Mismo problema al editar. Si el email se coloca, funciona. Archivado funciona."
severity: major
fixed_by: 02.5-10-PLAN.md

### 4b. Create, Edit Athletes with Empty Email (Re-verification)
expected: Leave email empty, fill required fields → saves without 500 error. Edit with empty email → saves without error.
result: pass

### 5. Generate Invitation Links
expected: Click row menu on athlete → "Generate Invite". Success toast, link copied. Athlete row shows invitation status (pending/accepted).
result: issue
reported: "Se genera la invitacion correctamente pero no hay acceso a los links ya generados. Si se pierde el link, hay que regenerar constantemente. Deberia ser un modal que muestre invitaciones existentes y permita copiar o regenerar."
severity: major
fixed_by: 02.5-11-PLAN.md

### 5b. View Existing Invitation Links (Re-verification)
expected: Click "Ver invitacion" row action → modal shows invitation URL, status badge, expiration date. Copy button copies URL to clipboard. Regenerate button creates new invitation.
result: pass
note: Fixed by quick-014 and quick-016 (unified Invitar action, truncated URL, skeleton loading)

### 6. Exercise Browser with Filters
expected: /exercises shows exercise table. Muscle group dropdown filters exercises. Movement pattern dropdown filters. Search by name works. Filters combine correctly.
result: issue
reported: "Tabla se ve bien pero filtro de músculo no funciona. Ningún ejercicio del seed tiene músculos asociados. Bug encontrado: seed guarda muscleGroupId como 'mg-chest' pero isValidMuscleGroup() espera 'chest' sin prefijo."
severity: major
fixed_by: 02.5-10-PLAN.md

### 6b. Exercise Muscle Group Filter (Re-verification)
expected: Exercises show their muscle groups in table. Muscle group dropdown filters and returns matching exercises.
result: pass

## Summary

total: 9
passed: 6
issues: 3
pending: 0
skipped: 0

## Gaps

- truth: "Create/Edit athlete works with empty email field"
  status: failed
  reason: "User reported: Frontend validation passes empty email, backend rejects with VALIDATION_ERROR 500. Same issue on create and edit. Works if email is provided."
  severity: major
  test: 4
  root_cause: "Procedure uses ?? instead of || for email coercion. Empty string passes through unchanged, then fails domain entity email regex validation."
  artifacts:
    - path: "packages/backend/src/procedures/athletes/create-athlete.ts:28"
      issue: "email: input.email ?? null - should use || to coerce empty string"
    - path: "packages/backend/src/procedures/athletes/update-athlete.ts"
      issue: "Same issue with email coercion"
  missing:
    - "Change ?? to || for email, phone, notes fields in create/update procedures"
  debug_session: ".planning/debug/athlete-validation-mismatch.md"

- truth: "Coach can view and copy existing invitation links"
  status: failed
  reason: "User reported: Invitation generates correctly but no way to access previously generated links. Must regenerate if lost. Should be modal showing existing invitations with copy/regenerate options."
  severity: major
  test: 5
  root_cause: "No procedure to fetch athlete's current invitation. Frontend only has generateInvitation which returns URL once then it's lost."
  artifacts:
    - path: "packages/contracts/src/athletes/invitation.ts"
      issue: "Output schema only returns invitationUrl, no full invitation object"
    - path: "apps/coach-web/src/features/athletes/components/athletes-table.tsx"
      issue: "No 'view invitation' action"
  missing:
    - "Add getAthleteInvitation procedure returning full invitation with URL/status/expiration"
    - "Add modal UI to view/copy/regenerate invitations"
    - "Add 'Ver invitacion' row action"
  debug_session: ".planning/debug/invitation-links-ux.md"

- truth: "Exercises display associated muscle groups and muscle filter works"
  status: failed
  reason: "Seed data stores muscleGroupId as 'mg-chest' but isValidMuscleGroup() expects 'chest' without prefix. All muscle mappings fail validation, exercises appear with no muscles."
  severity: major
  test: 6
  root_cause: "Repository mapToDomain() uses isValidMuscleGroup(mapping.muscleGroupId) but DB has 'mg-chest' format while validator expects 'chest'"
  artifacts:
    - path: "packages/backend/src/infrastructure/repositories/exercise.repository.ts"
      issue: "isValidMuscleGroup checks raw muscleGroupId without stripping mg- prefix"
    - path: "packages/database/src/seed/exercises.ts"
      issue: "muscleGroupId uses mg-{muscle} format"
  missing:
    - "Strip mg- prefix when validating muscleGroupId in repository OR store without prefix in seed"
  debug_session: ""

- truth: "Invitation modal UX: single 'Invitar' action, truncated URL"
  status: resolved
  reason: "User reported: Should be single 'Invitar' action that opens modal. If invitation exists, show with copy. If not, show create button. URL overflows modal - should truncate with ellipsis."
  severity: minor
  test: 5b
  fixed_by: quick-014, quick-016
  resolution: "Unified 'Invitar' action, skeleton loading, contextual button labels, truncated URL display"
