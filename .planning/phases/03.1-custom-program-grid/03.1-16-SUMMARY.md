---
phase: 03.1-custom-program-grid
plan: 16
subsystem: frontend-programs
tags: [combobox, empty-state, base-ui, css-visibility]
dependency-graph:
  requires: [03.1-08]
  provides: [correct-athlete-selector-empty-state]
  affects: []
tech-stack:
  added: []
  patterns: [base-ui-combobox-structure]
key-files:
  created: []
  modified:
    - apps/coach-web/src/features/programs/components/program-form.tsx
decisions: []
metrics:
  duration: 1 min
  completed: 2026-01-25
---

# Phase 03.1 Plan 16: Athlete Selector Empty State Fix Summary

ComboboxEmpty moved inside ComboboxList for proper CSS visibility control via Base UI's data-empty attribute.

## What Was Built

Fixed the athlete selector empty state visibility bug in the program creation form. The ComboboxEmpty component was incorrectly positioned as a sibling of ComboboxList, causing the CSS visibility rules (`group-data-empty/combobox-content:flex`) to not work correctly. The empty state "No se encontraron atletas" was showing even when athletes existed.

**Root cause:** Base UI sets the `data-empty` attribute on the ComboboxList element. CSS selectors like `group-data-empty/combobox-content:flex` only work when ComboboxEmpty is a descendant of the element with `data-empty`.

**Fix:** Moved ComboboxEmpty from being a sibling of ComboboxList to being its last child.

## Key Changes

### 1. ComboboxEmpty Placement (program-form.tsx)

**Before (broken):**
```tsx
<ComboboxContent>
  <ComboboxList>
    {athletes.map(...)}
  </ComboboxList>
  <ComboboxEmpty>No se encontraron atletas</ComboboxEmpty>  <!-- sibling -->
</ComboboxContent>
```

**After (fixed):**
```tsx
<ComboboxContent>
  <ComboboxList>
    {athletes.map(...)}
    <ComboboxEmpty>No se encontraron atletas</ComboboxEmpty>  <!-- child -->
  </ComboboxList>
</ComboboxContent>
```

## Files Modified

| File | Changes |
|------|---------|
| `apps/coach-web/src/features/programs/components/program-form.tsx` | Moved ComboboxEmpty inside ComboboxList |

## Verification

- [x] ComboboxEmpty is inside ComboboxList
- [x] TypeScript compiles for program-form.tsx
- [x] Biome lint passes for program-form.tsx
- [x] Pattern match `ComboboxList[\s\S]*ComboboxEmpty` satisfied

## Commits

| Hash | Message |
|------|---------|
| e749086 | fix(03.1-16): move ComboboxEmpty inside ComboboxList for proper visibility |

## Deviations from Plan

None - plan executed exactly as written.

## Next Phase Readiness

This was a gap closure plan (16 of 17). Plan 17 will address the remaining issue from UAT v4.
