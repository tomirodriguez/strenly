---
status: diagnosed
phase: 03.1-custom-program-grid
source:
  - 03.1-12-SUMMARY.md
  - 03.1-13-SUMMARY.md
started: 2026-01-25T19:00:00Z
updated: 2026-01-25T19:15:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Athlete Selector Keyboard Accessibility (Re-test)
expected: Open create program form. Click athlete selector. Type to search. Use arrow keys to navigate results. Press Enter to select. Press Escape to close.
result: issue
reported: "Se sigue viendo mal. Siempre que se abre el dropdown aparece abajo de todo 'No se encontraron atletas'. También aparece como opción el 'sin atleta asignado'. Esa no debería ser una opción. Simplemente si no hay ninguno seleccionado, se entiende que es eso, no hace falta un item en la lista. La forma de deseleccionarlo es con la X que hay a la derecha del combobox o en todo caso, seleccionando un item ya seleccionado, que lo deseleccione"
severity: minor

### 2. Superset Menu Shows Existing Groups (Re-test)
expected: Add 3 exercises. Put first two in superset A (A1, A2). Select third exercise (C1). Open actions menu. "Agregar a superserie" shows "A" option plus "Crear superserie B".
result: issue
reported: "Seguimos con el mismo problema. Si agrego B1 a superserie A, se crean dos items A1: uno el ejercicio normal y otro el ejercicio de superserie. No se combinan y se crea correctamente la superserie"
severity: major

### 3. Adding to Superset Repositions Row (Re-test)
expected: With A1, A2, C1 (C1 not adjacent to A group). Add C1 to superset A. Row physically moves to be adjacent to A1-A2. Displays as A3. Blue indicator connects all three.
result: pass

### 4. Dynamic Superset Order on Reorder
expected: Have A1, A2, A3 superset. Drag/reorder A3 to be between A1 and A2. Display updates to show A1, A2 (was A3), A3 (was A2). Order numbers reflect physical position.
result: pass

### 5. Non-Superset Row After Superset Group
expected: Have superset A1, A2, A3. Add a new exercise (not in superset). New exercise shows B1 (next letter after group A), not D1.
result: issue
reported: "Las filas no están contando el agrupamiento de series. Si tengo A1, A2, A3, la siguiente si no está en la superserie debería ser B1. Muestra D1 ya que cuenta por cantidad"
severity: major

## Summary

total: 5
passed: 2
issues: 3
pending: 0
skipped: 0

## Gaps

- truth: "Athlete selector dropdown shows only athletes, no empty/deselect option in list"
  status: failed
  reason: "User reported: 'No se encontraron atletas' always shows at bottom. 'Sin atleta asignado' appears as option but shouldn't - deselection via X button or re-clicking selected item"
  severity: minor
  test: 1
  root_cause: "Hardcoded 'Sin atleta asignado' ComboboxItem at lines 144-147. X button already exists for clearing (showClear). Remove the static option."
  artifacts:
    - path: "apps/coach-web/src/features/programs/components/program-form.tsx"
      issue: "Lines 144-147: Explicit 'Sin atleta asignado' option that should be removed"
  missing:
    - "Remove lines 144-147 (the ComboboxItem with value='')"
  debug_session: ".planning/debug/athlete-selector-ux-issues.md"

- truth: "Adding exercise to superset combines them into one group with sequential order (A1, A2)"
  status: failed
  reason: "User reported: Adding B1 to superset A creates two A1 items - original exercise and superset exercise. They don't combine correctly into a proper superset."
  severity: major
  test: 2
  root_cause: "Visual label collision in exercise-row-prefix.tsx. Two systems use same letter namespace: superset rows use 'A1' from supersetGroup, non-superset rows use 'A1' from POSITION_LETTERS[0]. Both produce 'A1' causing visual duplicates."
  artifacts:
    - path: "apps/coach-web/src/components/programs/program-grid/exercise-row-prefix.tsx"
      issue: "Lines 10, 23-32: POSITION_LETTERS uses same A,B,C as superset groups"
  missing:
    - "Labels should be based on logical groups, not physical row position"
    - "Superset group A (A1,A2,A3) counts as one letter usage, next non-superset should be B1"
  debug_session: ".planning/debug/superset-duplicate-a1.md"

- truth: "Non-superset row after superset group uses next available letter (B1 after group A)"
  status: failed
  reason: "User reported: Las filas no están contando el agrupamiento de series. Si tengo A1, A2, A3, la siguiente si no está en la superserie debería ser B1. Muestra D1 ya que cuenta por cantidad"
  severity: major
  test: 5
  root_cause: "Same as test 2. POSITION_LETTERS[position] uses physical row index (3 = D) instead of logical group count (A is one group, next = B)."
  artifacts:
    - path: "apps/coach-web/src/components/programs/program-grid/exercise-row-prefix.tsx"
      issue: "Uses physical position instead of logical group count"
  missing:
    - "Calculate logical group index: count distinct superset groups + count non-superset rows before this one"
    - "A1,A2,A3 = group index 0 (letter A), next non-superset = group index 1 (letter B)"
  debug_session: ""
  related_to: 2
