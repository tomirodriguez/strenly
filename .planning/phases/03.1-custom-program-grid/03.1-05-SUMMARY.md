---
phase: 03.1
plan: 05
subsystem: frontend/program-grid
tags: [react, exercise-cell, combobox, superset-indicator]

dependency-graph:
  requires: [03.1-03]
  provides: [exercise-cell-component, row-prefix-component, superset-indicator]
  affects: [03.1-06, 03.1-07]

tech-stack:
  added: []
  patterns: [sticky-column, combobox-editing, row-actions-on-hover]

key-files:
  created:
    - apps/coach-web/src/components/programs/program-grid/exercise-cell.tsx
    - apps/coach-web/src/components/programs/program-grid/exercise-row-prefix.tsx
    - apps/coach-web/src/components/programs/program-grid/superset-indicator.tsx
  modified:
    - apps/coach-web/src/components/programs/program-grid/add-exercise-row.tsx

decisions:
  - id: enter-f2-to-edit
    title: "Enter or F2 to start editing"
    context: "Excel convention for entering edit mode"
    choice: "Support both Enter and F2 keys"
    rationale: "Familiar UX for spreadsheet users"

metrics:
  duration: 3.5 min
  completed: 2026-01-25
---

# Phase 03.1 Plan 05: Exercise Cell and Row Prefix Summary

ExerciseCell and ExerciseRowPrefix components for first column of program grid with combobox editing.

## What Was Built

### SupersetIndicator Component
- Vertical blue line connecting exercises in same superset group
- Three positions: start (first in group), middle, end (last in group)
- 1.5px width, primary color at 40% opacity per UI/UX spec

### ExerciseRowPrefix Component
- Shows superset group (A1, B2, C1) or position letter (A1, B1) for non-superset rows
- Superset rows: primary color text with background-dark bg
- Non-superset rows: muted text with slightly darker bg
- Fixed 40px width with border-right

### ExerciseCell Component
- **View mode**: Exercise name with proper styling, set type badge for split rows, row actions menu on hover
- **Edit mode**: Searchable combobox for exercise selection
- Keyboard support: Enter/F2 to edit, Escape to cancel
- Sticky first column with shadow for horizontal scroll
- Uses existing ExerciseRowActions component for menu

## Commits

| Hash | Type | Description |
|------|------|-------------|
| d62192c | feat | Add ExerciseRowPrefix and SupersetIndicator |
| acb2af2 | feat | Add ExerciseCell with combobox editing |

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 1 - Bug] Fixed nullable value handling in Combobox onValueChange**
- **Found during:** Task 2
- **Issue:** Combobox onValueChange passes `string | null`, but handler expected `string`
- **Fix:** Added null guard `if (!value) return` in handleSelect
- **Files modified:** exercise-cell.tsx, add-exercise-row.tsx
- **Commit:** acb2af2

## Architecture Notes

The exercise cell follows the same patterns as the UI/UX specification:
- 320px first column with sticky positioning
- Shadow effect on horizontal scroll: `shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]`
- Split row styling: dimmed exercise name (text-foreground/50) with set type badge

## Verification Results

1. TypeScript compiles without errors
2. Biome lint passes
3. ExerciseRowPrefix shows correct labels (A1, B1, B2 for supersets)
4. ExerciseCell displays exercise name and set type badge
5. Click/Enter/F2 opens combobox for exercise search
6. Selecting exercise calls onCommit with correct data
7. Row actions menu appears on hover

## Next Phase Readiness

- Exercise cell ready for integration in grid body
- Superset indicator ready for visual grouping
- Next plan (03.1-06) can build prescription cells using same patterns
