---
status: diagnosed
phase: 03.1-custom-program-grid
source:
  - 03.1-14-SUMMARY.md
  - 03.1-15-SUMMARY.md
started: 2026-01-25T20:00:00Z
updated: 2026-01-25T20:30:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Athlete Selector Without Redundant Option
expected: Open create program form. Click athlete selector dropdown. The dropdown shows only actual athletes - there is NO "Sin atleta asignado" option in the list. The X button next to the selector clears the selection.
result: issue
reported: "Se sigue viendo abajo de todo 'No se encontraron atletas'. El resto funciona"
severity: minor

### 2. Unified Row Labeling - Standalone Exercises
expected: Create a program. Add 3 exercises to a session (no supersets). Each exercise shows a unique letter with index 1: A1, B1, C1. Not A, B, C or 1, 2, 3.
result: pass
note: "User confirmed labeling works. Noted separate positioning bug for superset add/remove."

### 3. Unified Row Labeling - Superset Group
expected: Add 3 exercises. Put all three in superset group A. They display as A1, A2, A3 with sequential numbering based on position.
result: pass

### 4. Unified Row Labeling - Mixed Groups
expected: Have A1, A2 (superset), then add two more exercises as standalone. They should show B1, C1 (next letters after group A), not C1, D1.
result: pass

### 5. Unified Row Labeling - After Superset Removal
expected: Have A1, A2, A3 (superset). Remove A2 from superset. Display updates: A1, A2 (remaining superset), B1 (the removed exercise now standalone). The removed exercise should move below the superset group.
result: issue
reported: "Si tengo A1, A2, A3 y elimino a A2 de la superserie, se pasa a llamar B1 pero sigue en el lugar entre A1 y el que era A3 (ahora A2). Deberia ir abajo y no en el medio. Ademas sigo pudiendo mover items fuera de la superserie entre ejercicios de la superserie con el boton de mover arriba o abajo. El problema en esencia es el mismo - hay que ordenar bien las filas cuando se quita/agrega un ejercicio de la superserie o se mueve arriba/abajo"
severity: major

## Summary

total: 5
passed: 3
issues: 2
pending: 0
skipped: 0

## Gaps

- truth: "Athlete selector shows only athletes, no erroneous empty state when results exist"
  status: failed
  reason: "User reported: Se sigue viendo abajo de todo 'No se encontraron atletas'. El resto funciona"
  severity: minor
  test: 1
  root_cause: "ComboboxEmpty is rendered outside ComboboxList (as sibling) causing CSS visibility rules to not properly hide it when athletes exist"
  artifacts:
    - path: "apps/coach-web/src/features/programs/components/program-form.tsx"
      issue: "Line 159: ComboboxEmpty after </ComboboxList> instead of inside"
  missing:
    - "Move ComboboxEmpty inside ComboboxList after athletes.map()"
  debug_session: ".planning/debug/athlete-selector-empty-state.md"

- truth: "Superset rows stay physically adjacent - removing from superset moves row outside group, move up/down respects superset boundaries"
  status: failed
  reason: "User reported: Al eliminar A2 de superserie A1,A2,A3, se renombra a B1 pero queda entre A1 y A2. Debería moverse abajo. También se puede mover items fuera de la superserie entre ejercicios con mover arriba/abajo. Hay que ordenar filas cuando se quita/agrega de superserie o se mueve."
  severity: major
  test: 5
  root_cause: "toggle-superset only repositions rows when ADDING to superset (lines 113-124) but not when REMOVING (lines 56-70); reorder-exercise-rows accepts any order without validating superset adjacency"
  artifacts:
    - path: "packages/backend/src/use-cases/programs/toggle-superset.ts"
      issue: "Lines 56-70: Removal only updates metadata, no repositioning"
    - path: "packages/backend/src/use-cases/programs/reorder-exercise-rows.ts"
      issue: "Lines 19-44: No validation to prevent breaking superset adjacency"
  missing:
    - "toggle-superset: Add repositioning logic when removing from superset (move to end of session)"
    - "reorder-exercise-rows: Add validation/auto-repair to keep superset groups adjacent"
  debug_session: ".planning/debug/superset-row-positioning.md"
