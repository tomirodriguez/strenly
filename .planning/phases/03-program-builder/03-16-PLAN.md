---
phase: 03-program-builder
plan: 16
type: execute
wave: 8
depends_on: ["03-14", "03-15"]
files_modified:
  - apps/coach-web/src/components/layout/app-sidebar.tsx
  - apps/coach-web/src/routes/_authenticated/$orgSlug/programs/index.tsx
  - apps/coach-web/src/components/programs/keyboard-shortcuts-footer.tsx
autonomous: false

must_haves:
  truths:
    - "Programs link appears in sidebar navigation"
    - "Keyboard shortcuts are visible in editor footer"
    - "Full program builder flow works end-to-end"
    - "All success criteria from phase are met"
  artifacts:
    - path: "apps/coach-web/src/components/programs/keyboard-shortcuts-footer.tsx"
      provides: "Footer with keyboard shortcut hints"
      exports: ["KeyboardShortcutsFooter"]
  key_links:
    - from: "apps/coach-web/src/components/layout/app-sidebar.tsx"
      to: "apps/coach-web/src/routes/_authenticated/$orgSlug/programs/index.tsx"
      via: "navigation link"
      pattern: "/programs"
---

<objective>
Complete the program builder integration with navigation and final polish.

Purpose: Deliver a complete, polished program builder experience.
Output: Sidebar navigation, keyboard shortcuts footer, and final UAT.
</objective>

<execution_context>
@/Users/tomiardz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tomiardz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-program-builder/03-14-SUMMARY.md
@.planning/phases/03-program-builder/03-15-SUMMARY.md
@apps/coach-web/src/components/layout/app-sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add programs to sidebar navigation</name>
  <files>apps/coach-web/src/components/layout/app-sidebar.tsx</files>
  <action>
Update the sidebar navigation to include Programs link:

Find the navigation items array and add Programs after Dashboard:

```typescript
const navItems = [
  { title: 'Dashboard', href: `/${orgSlug}/dashboard`, icon: LayoutDashboard },
  { title: 'Programas', href: `/${orgSlug}/programs`, icon: FileSpreadsheet }, // ADD THIS
  { title: 'Atletas', href: `/${orgSlug}/athletes`, icon: Users },
  { title: 'Ejercicios', href: `/${orgSlug}/exercises`, icon: Dumbbell },
]
```

Use `FileSpreadsheet` icon from lucide-react (or similar grid/table icon).
  </action>
  <verify>pnpm dev:coach - sidebar shows Programs link</verify>
  <done>Programs navigation added to sidebar</done>
</task>

<task type="auto">
  <name>Task 2: Create keyboard shortcuts footer</name>
  <files>apps/coach-web/src/components/programs/keyboard-shortcuts-footer.tsx</files>
  <action>
Create footer component showing keyboard shortcuts:

```typescript
export function KeyboardShortcutsFooter() {
  return (
    <footer className="h-16 border-t border-border bg-background flex items-center justify-between px-6">
      {/* Left side: intensity indicator (future) */}
      <div className="flex items-center gap-8 text-[11px] font-medium uppercase tracking-wider text-muted-foreground">
        {/* Placeholder for future intensity metrics */}
      </div>

      {/* Right side: keyboard shortcuts */}
      <div className="flex items-center gap-4">
        <div className="flex items-center gap-2 bg-muted/50 px-2.5 py-1 rounded border border-border">
          <kbd className="text-muted-foreground font-bold bg-muted px-1 rounded text-[9px]">Shift + Enter</kbd>
          <span className="text-[10px]">Add Sub-row (Split)</span>
        </div>
        <div className="flex items-center gap-2 bg-muted/50 px-2.5 py-1 rounded border border-border">
          <kbd className="text-muted-foreground font-bold bg-muted px-1 rounded text-[9px]">S</kbd>
          <span className="text-[10px]">Toggle Superset</span>
        </div>
        <div className="flex items-center gap-2 bg-muted/50 px-2.5 py-1 rounded border border-border">
          <kbd className="text-muted-foreground font-bold bg-muted px-1 rounded text-[9px]">←↑↓→</kbd>
          <span className="text-[10px]">Navegar</span>
        </div>
        <div className="flex items-center gap-2 bg-muted/50 px-2.5 py-1 rounded border border-border">
          <kbd className="text-muted-foreground font-bold bg-muted px-1 rounded text-[9px]">Enter</kbd>
          <span className="text-[10px]">Editar Celda</span>
        </div>
      </div>
    </footer>
  )
}
```

Add this footer to the program editor page layout.
  </action>
  <verify>pnpm typecheck in apps/coach-web</verify>
  <done>Keyboard shortcuts footer created</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Program Builder feature including:

**Backend:**
- Database schema: programs, weeks, sessions, exercise rows, prescriptions
- Domain entities: Program, Prescription with validation
- Repository with all CRUD operations
- Use cases: create, get, list, update, archive, duplicate programs
- Use cases: add/update/delete weeks, sessions, exercise rows
- Use cases: update prescription, add split row, toggle superset
- Template system: save as template, create from template
- Full API via oRPC procedures

**Frontend:**
- Programs list page with cards, filters, and search
- Create program form with template selector
- Program editor with Excel-like grid
- Prescription notation parsing (3x8@120kg, 4x6-8@RIR2, etc.)
- Keyboard navigation (arrow keys, tab, enter, escape)
- Week actions (rename, duplicate, delete)
- Exercise row actions (split, superset, delete, reorder)
- Save as template dialog
- Sidebar navigation
- Keyboard shortcuts footer
  </what-built>
  <how-to-verify>
**Test Phase 3 Success Criteria:**

1. **PRG-04: Keyboard navigation without mouse**
   - Navigate to program editor
   - Use only arrow keys to move between cells
   - Press Tab to move to next cell
   - Press Enter to edit, type value, press Enter to confirm
   - Press Escape to cancel edit
   - Complete navigation test without touching mouse

2. **PRG-03: Inline editing without modals**
   - Click any prescription cell
   - Edit value directly in cell (no modal opens)
   - Navigate away to save

3. **PRG-07: Natural notation parsing**
   - Type "3x8@120kg" → should parse to structured data
   - Type "4x6-8@RIR2" → should parse rep range + RIR
   - Type "3x10@75%" → should parse percentage
   - Type "3x8@120kg (3110)" → should parse with tempo
   - Type "—" → should show as skip

4. **PRG-05: Full mesocycle view (4-6 weeks)**
   - Create program with 4+ weeks
   - All weeks visible at once (horizontal scroll if needed)
   - Each cell shows prescription clearly

5. **PRG-06: 3+ prescription params visible**
   - Each cell shows: sets x reps @ intensity
   - Optional: tempo visible in notation

6. **PRG-08: Duplicate programs**
   - Click program menu → Duplicate
   - New program created with all data copied

7. **PRG-09: Duplicate weeks**
   - Click week menu → Duplicate
   - New week appears with all prescriptions copied

8. **RX-10: Superset grouping (A1/A2)**
   - Press S on row → select superset group
   - Visual connector line appears between grouped exercises

9. **TPL-01 to TPL-04: Templates**
   - Save program as template
   - Create new program from template
   - Templates show in selector with metadata
   - Templates are organization-private (can't see other org's templates)

**Overall:**
- Flow feels as fast as Excel for creating programs
- No page reloads or slow operations
- Keyboard shortcuts work as documented
  </how-to-verify>
  <resume-signal>Type "approved" if all success criteria pass, or list specific failures</resume-signal>
</task>

</tasks>

<verification>
1. Run `pnpm typecheck` - all code type-checks
2. Run `pnpm dev` - start all apps
3. Complete full UAT flow above
4. Verify no console errors
5. Verify all mutations persist to database
</verification>

<success_criteria>
- All 5 Phase 3 success criteria from ROADMAP.md are met:
  1. Keyboard navigation works without mouse
  2. Inline editing works without modals
  3. Natural notation parses correctly
  4. Full mesocycle view (4-6 weeks) visible
  5. Duplicate and template operations work
</success_criteria>

<output>
After completion, create `.planning/phases/03-program-builder/03-16-SUMMARY.md`
</output>
